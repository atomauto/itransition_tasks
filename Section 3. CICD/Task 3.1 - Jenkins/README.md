# Task 3.1 Jenkins
Задача решена с использованием следующей архитектуры. С помощью vagrant создаются локальные виртуальные машины, одна из которых является управляющей, на управляющей машине устанавливается Ansible, далее с его помощью устанавливается Jenkins. Наше php приложение из ветки staging будет деплоится в виде docker контейнера на виртуальную машину (тестовая среда). Доступ к репозиторию организован через GitHub токен. Так как webhook от Github не проходит на виртуальную машину через NAT, для упрощения было решено включить Poll SCM. СУБД для staging (тестовая среда) возможно будет находится также на отдельной виртуальной машине. Деплой из ветки master после подтверждения pull request будет уже осуществляться на свой инстанс на aws c возможностью доступа из интернета через поддомен.
# Задача
Установить Jenkins. Это может быть установка на ваш локальный компьютер или на инстансе в облаке, это не имеет значение, как не имеет значение и метод установки (с использованием docker контейнера, playbook или установка вручную из репозитория и пр.). 
1. Создать новый проект “Staging”, в нем добавить задачу для сборки простого приложения, например 
- .net: https://github.com/chaitalidey6/HelloWorldAspNetCore/tree/master/HelloWorldAsp
- Java: https://github.com/jenkins-docs/simple-java-maven-app
- Node JS: https://github.com/jenkins-docs/simple-node-js-react-npm-app
##### Замечания:
* Вы можете использовать любое привычное приложение на любом языке 
(.net, java, js, python, php). 
* Код приложения должен быть размещен в вашем собственном git-репозитории. 
* Должна использоваться ветка“staging”.
* Приложение может быть собрано в контейнере (предпочтительный способ).
* Задача по сборке должна запускаться с параметрами.
* Результатом сборки обязательно должен быть артефакт (архив, docker-контейнер), который вы дальше будете использовать.
* Необходимо самостоятельно подумать над тем,каким образом Jenkins/TeamCity получит доступ к git-репозиторию, при этом необходимо придумать наиболее безопасный на ваш вгляд способ. 
2. Создать задачу в Jenkins /Teamcity для деплоя вашего артефакта на сервер и перезапуск приложения.
##### Замечания: 
* Здесь артефакт может доставляться на удаленный сервер(например,на EC2 инстанс в AWS), либо на контейнер (при работе локально в Docker), либо на локальный сервер (при работе с Vagrant/VirtualBox). 
* Необходимо самостоятельно подумать над тем,каким образом будет организован доступ из Jenkins/Teamcity на сервер (для загрузки артефактов), при этом необходимо придумать наиболее безопасный на ваш вгляд способ. 
3. Настроить зависимость задачи деплоя от задачи сборки. 
4. Настроить деплой артефакта в место, где он будет работать, и запуск приложения. 
5. Добавить задачу создания бэкапа артефактов на сервере. 
6. Настроить пайплайн, где должны быть включены шаги: сборка, бэкап и деплой (опционально: тестирование). 
7. Настроить автоматический запуск деплоя при добавлении нового commit’а в ветке `staging` git. 
 > При запуске локально – здесь могут быть проблемы с настройкой webhook, потому используйте другой метод взаимодействия с git. 
8. Создать новый проект “Production”, добавить задачу для сборки приложения, выполнить те же настройки, что и в Staging (п. 2), но с небольшими изменениями: должна использоваться ветка `master`. 
9. Создать задачу для деплоя Production артефактов на сервер (здесь может использоваться тот же сервер, но приложения должны быть различными: «висеть» на разных портах или под разными доменами). 
10. Настроить зависимость задачи деплоя от задачи сборки. 
11. Настроить автоматический запуск деплоя при подтверждении pull request’а в ветке `master` в git. 